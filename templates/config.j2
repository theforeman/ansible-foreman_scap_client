# DO NOT EDIT THIS FILE MANUALLY
# IT IS MANAGED BY ANSIBLE
# ANY MANUAL CHANGES WILL BE LOST ON THE NEXT ANSIBLE EXECUTION

# Foreman proxy to which reports should be uploaded
SERVER="{{ foreman_scap_client_server }}"
PORT={{ foreman_scap_client_port }}

# Timeout for sending reports to proxy
TIMEOUT={{ foreman_scap_client_timeout }}

{% if foreman_scap_client_ciphers | length > 0 %}
# Ciphers used when negotiating connection with scap server
CIPHERS=({{ foreman_scap_client_ciphers | to_json | regex_replace('[\[\]]', '') | regex_replace(',', ' ') }})
{% endif %}

# Should --fetch-remote-resources be added to `oscap xccdf eval` command
FETCH_REMOTE_RESOURCES="{{ foreman_scap_client_fetch_remote_resources | lower }}"

# HTTP proxy server for downloading remote resources
HTTP_PROXY_SERVER="{{ foreman_scap_client_http_proxy_server }}"
HTTP_PROXY_PORT="{{ foreman_scap_client_http_proxy_port }}"

## SSL specific options ##
# Client CA file.
# It could be any valid certificate that is accepted by foreman-proxy, such as Puppet CA certificate (e.g., '/var/lib/puppet/ssl/certs/ca.pem')
# Or (recommended for client reporting to Katello) subscription manager CA file, (e.g., '/etc/rhsm/ca/katello-server-ca.pem')
CA_FILE="{{ foreman_scap_client_ca_cert_path if foreman_scap_client_ca_cert_path != '' else rh_ca_cert_path }}"
# Client host certificate.
# It could be Puppet agent host certificate (e.g., '/var/lib/puppet/ssl/certs/myhost.example.com.pem')
# Or (recommended for client reporting to Katello) consumer certificate (e.g., '/etc/pki/consumer/cert.pem')
HOST_CERTIFICATE="{{ foreman_scap_client_host_cert_path if foreman_scap_client_host_cert_path != '' else rh_consumer_cert_path }}"
# Client private key
# It could be Puppet agent private key (e.g., '/var/lib/puppet/ssl/private_keys/myhost.example.com.pem')
# Or (recommended for client reporting to Katello) consumer private key (e.g., '/etc/pki/consumer/key.pem')
HOST_PRIVATE_KEY="{{ foreman_scap_client_host_private_key_path if foreman_scap_client_host_private_key_path != '' else rh_consumer_private_key_path }}"

# policy (key is id as in Foreman)
{% for policy in foreman_scap_client_policies %}
POLICY_{{ policy['id'] }}_PROFILE="{{ policy['profile_id'] }}"
POLICY_{{ policy['id'] }}_CONTENT_PATH="{{ policy['content_path'] }}"
# Download path
# A path to download SCAP content from proxy
POLICY_{{ policy['id'] }}_DOWNLOAD_PATH="{{ policy['download_path'] }}"
POLICY_{{ policy['id'] }}_TAILORING_PATH="{{ policy['tailoring_path'] }}"
POLICY_{{ policy['id'] }}_TAILORING_DOWNLOAD_PATH="{{ policy['tailoring_download_path'] }}"
{% endfor %}
